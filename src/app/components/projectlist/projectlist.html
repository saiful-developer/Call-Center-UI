<div class="content-wrapper">

  <app-page-header title="Project List" iconClass="mdi-format-list-checkbox"></app-page-header>


  <div class="container-fluid">
    <div class="search-bar-wrapper">
      <form class="search-project d-lg-flex flex-wrap gap-2 align-items-center" [formGroup]="searchForm"
        (ngSubmit)="getSearchedResult()">
        <!-- Always visible inputs -->
        <input type="text" class="form-control modern-input" placeholder="Name" formControlName="search_name" />
        <input type="text" class="form-control modern-input" placeholder="ID" formControlName="search_id" />
        <input type="text" class="form-control modern-input" placeholder="Role" formControlName="search_role" />

        <!-- Toggle Button for dropdown inputs (only on small screens) -->
        <button id="filterToggleBtn" class="btn  d-lg-none small-toggle" type="button" data-bs-toggle="collapse"
          data-bs-target="#moreSearchFields" aria-expanded="false" aria-controls="moreSearchFields">
          More <span id="toggleIcon" class="bi bi-chevron-down"></span>
        </button>

        <!-- Collapsible Search Inputs -->
        <div class="collapse d-lg-flex gap-2 align-items-center" id="moreSearchFields">
          <input type="email" class="form-control modern-input" placeholder="Email" formControlName="search_email" />
          <input type="text" class="form-control modern-input" placeholder="Title"
            formControlName="search_project_title" />
          <input type="text" class="form-control modern-input" placeholder="Type"
            formControlName="search_prject_type" />
          <input type="text" class="form-control modern-input" placeholder="Assigned"
            formControlName="search_assigned_by" />
        </div>

        <!-- Search Button -->
        <button type="submit" class="btn modern-btn">
          <i class="bi bi-search me-1"></i> Search
        </button>
      </form>
    </div>
  </div>






  <div class="d-none d-md-block">
    <table class="table  table-hover  shadow-sm rounded">
      <thead class="">
        <tr>
          <th>#</th>
          <th>User Name</th>
          <th>User ID</th>
          <th>User Role</th>
          <th>Email</th>
          <th>Project Title</th>
          <th>Project Type</th>
          <th>Assigned By</th>
          <th>Start Time</th>
          <th>End Time</th>
          <th>Description</th>
          <!-- <th>Created At</th> -->
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let project of pagedListFromChild; let i = index">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ project.user_name }}</td>
          <td>{{ project.user_id }}</td>
          <td>{{ project.user_role }}</td>
          <td class="text-break">{{ project.email }}</td>
          <td>{{ project.project_title }}</td>
          <td>{{ project.project_type }}</td>
          <td>{{ project.assigned_by }}</td>
          <td>{{ project.start_time }}</td>
          <td>
            <span *ngIf="project.end_time; else ongoing">{{ project.end_time }}</span>
            <ng-template #ongoing><span class="badge bg-success">Working</span></ng-template>
          </td>
          <td class="text-truncate" style="max-width: 200px;" [title]="project.project_description">
            {{ project.project_description }}
          </td>
        </tr>
      </tbody>

    </table>
  </div>

  <!-- Mobile Card View -->
  <div class="d-md-none">
    <div *ngFor="let project of pagedListFromChild; let i = index" class="card shadow-sm mb-3">
      <div class="card-body">
        <h5 class="card-title">{{ project.project_title }}</h5>
        <p class="mb-1"><strong>#{{ (currentPage - 1) * pageSize + i + 1 }}</strong></p>
        <p class="mb-1"><strong>User:</strong> {{ project.user_name }} ({{ project.user_id }})</p>
        <p class="mb-1"><strong>Role:</strong> {{ project.user_role }}</p>
        <p class="mb-1"><strong>Email:</strong> {{ project.email }}</p>
        <p class="mb-1"><strong>Type:</strong> {{ project.project_type }}</p>
        <p class="mb-1"><strong>Assigned By:</strong> {{ project.assigned_by }}</p>
        <p class="mb-1"><strong>Start:</strong> {{ project.start_time }}</p>
        <p class="mb-1"><strong>End:</strong>
          <span *ngIf="project.end_time; else ongoingMobile">{{ project.end_time }}</span>
          <ng-template #ongoingMobile><span class="badge bg-success">Working</span></ng-template>
        </p>
        <p class="mb-1"><strong>Description:</strong> {{ project.project_description }}</p>
        <p class="mb-0"><strong>Created:</strong> {{ project.created_at | date:'short' }}</p>
      </div>
    </div>
  </div>


  <app-paginator [projectList]="projects" (pageChanged)="handlePageChange($event)"></app-paginator>


</div>